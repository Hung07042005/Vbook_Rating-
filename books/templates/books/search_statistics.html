{% extends 'books/base.html' %}
{% block title %}Th·ªëng k√™ t√¨m ki·∫øm{% endblock %}
{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">Th·ªëng k√™ t√¨m ki·∫øm</h1>
    <div class="row mb-4">
        <div class="col-md-6">
            <h5 class="mb-2">üîé T·ª´ kh√≥a ƒë∆∞·ª£c t√¨m nhi·ªÅu nh·∫•t</h5>
            <ul class="list-group mb-3">
                {% for kw in top_keywords %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <span>{{ kw.query }}</span>
                    <span class="badge bg-primary rounded-pill">{{ kw.count }}</span>
                </li>
                {% empty %}
                <li class="list-group-item">Kh√¥ng c√≥ d·ªØ li·ªáu</li>
                {% endfor %}
            </ul>
            <h5 class="mb-2">‚ùå T·ª´ kh√≥a kh√¥ng c√≥ k·∫øt qu·∫£</h5>
            <ul class="list-group mb-3">
                {% for kw in no_result_keywords %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <span>{{ kw.query }}</span>
                    <span class="badge bg-danger rounded-pill">{{ kw.count }}</span>
                </li>
                {% empty %}
                <li class="list-group-item">Kh√¥ng c√≥ d·ªØ li·ªáu</li>
                {% endfor %}
            </ul>
        </div>
        <div class="col-md-6">
            <h5 class="mb-2">üë§ T√°c gi·∫£ ƒë∆∞·ª£c xem nhi·ªÅu</h5>
            <ul class="list-group mb-3">
                {% for author in top_authors %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <span>{{ author.name }}</span>
                    <span class="badge bg-success rounded-pill">{{ author.view_count }}</span>
                </li>
                {% empty %}
                <li class="list-group-item">Kh√¥ng c√≥ d·ªØ li·ªáu</li>
                {% endfor %}
            </ul>
            <h5 class="mb-2">üìö S√°ch ƒë∆∞·ª£c xem nhi·ªÅu</h5>
            <ul class="list-group mb-3">
                {% for book in top_books %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <span>{{ book.title }}</span>
                    <span class="badge bg-info rounded-pill">{{ book.view_count }}</span>
                </li>
                {% empty %}
                <li class="list-group-item">Kh√¥ng c√≥ d·ªØ li·ªáu</li>
                {% endfor %}
            </ul>
            <h5 class="mb-2">üè∑Ô∏è Th·ªÉ lo·∫°i ƒë∆∞·ª£c t√¨m nhi·ªÅu</h5>
            <ul class="list-group mb-3">
                {% for genre in top_genres %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <span>{{ genre.name }}</span>
                    <span class="badge bg-warning rounded-pill">{{ genre.search_count }}</span>
                </li>
                {% empty %}
                <li class="list-group-item">Kh√¥ng c√≥ d·ªØ li·ªáu</li>
                {% endfor %}
            </ul>
        </div>
    </div>
    <h5 class="mb-3">üïë L·ªãch s·ª≠ t√¨m ki·∫øm g·∫ßn ƒë√¢y</h5>
    <table class="table table-bordered table-hover">
        <thead>
            <tr>
                <th>Ng∆∞·ªùi d√πng</th>
                <th>T·ª´ kh√≥a t√¨m ki·∫øm</th>
                <th>Th·ªùi gian</th>
            </tr>
        </thead>
        <tbody>
            {% for log in logs %}
            <tr>
                <td>{% if log.user %}{{ log.user.username }}{% else %}Kh√°ch{% endif %}</td>
                <td>{{ log.query }}</td>
                <td>{{ log.searched_at|date:'d/m/Y H:i' }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="3" class="text-center">Ch∆∞a c√≥ d·ªØ li·ªáu</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
